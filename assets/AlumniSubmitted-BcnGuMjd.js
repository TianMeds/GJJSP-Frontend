import{r as J,j as e,a as K}from"./react-DyBbpTfo.js";import{T as X,i as T,G as m,B as q,a as h,k as Z,l as k,V as Q,j as ee,I as se,W as re,M as p,t as te,v as ie,w as ae,x as _,y as i,z as ne,c as N,X as Y,g as x,a2 as I,R as oe,H as le,J as de,K as ce,N as me}from"./@mui-BieppYyU.js";import{L as ue,S as he,a as pe,b as xe}from"./Layout-BTsGQOv-.js";import{t as je}from"./theme-D40dVDi4.js";import{a as fe,b as F}from"./index-CLUh4Q3Z.js";import{u as be}from"./LoaderAnimation-CH_DHjss.js";import{u as ge}from"./SubmissionStore-Ceg7ZcXh.js";import{u as Se,C as ve}from"./react-hook-form-BLdPXlwC.js";import{a as _e}from"./react-router-Cd-RU2wi.js";import"./@babel-8cBiVioP.js";import"./clsx-B-dksMZM.js";import"./@emotion-C_NMWrO_.js";import"./hoist-non-react-statics-Buxaj0Kl.js";import"./react-is-8JwjhRSi.js";import"./stylis-BqmD5Vow.js";import"./react-transition-group-es_vqKy0.js";import"./react-dom-BKrvlAQh.js";import"./scheduler-CzFDRTuY.js";import"./@react-spring-V1f4ptoc.js";import"./d3-color-9lF95FHy.js";import"./d3-shape-D9lAmgB5.js";import"./d3-path-CimkQT29.js";import"./d3-scale-CFwq3Dxo.js";import"./internmap-BkD7Hj8s.js";import"./d3-array-DJclFi1f.js";import"./d3-format-CzD4bSOQ.js";import"./d3-interpolate-lgBfS8Nc.js";import"./d3-time-format-DZUSPL1N.js";import"./d3-time-Dz5jZYzf.js";import"./@popperjs-BQBsAJpH.js";import"./react-router-dom-CzVCKb4Q.js";import"./@remix-run-B-RBrVrq.js";import"./UserStore-CIOHG4rb.js";import"./zustand-BzSMVJrz.js";import"./use-sync-external-store-C98n5-Y-.js";import"./axios-B4uVmeYG.js";function fs(){const M=Se(),{register:Ae,control:B,handleSubmit:ye,formState:Ce,reset:we,watch:L,validate:$e,setValue:Re}=M,j=_e(),{getAuthToken:A,alertOpen:Te,alertMessage:ke,setAlertOpen:f,setAlertMessage:b,errorOpen:Ne,setErrorOpen:n,setErrorMessage:o,errorMessage:Ye}=fe(),{setLoading:g,setLoadingMessage:D}=be(),{alumniForms:l,setAlumniForms:O,filteredSubmission:S,setFilteredSubmission:W,searchQuery:u,handleSearch:z,selectedSubmission:Ie,setSelectedSubmission:E,passYear:Fe,setPassYear:P,modalAlumni:V,setModalAlumni:y,alumniIdToSend:G,setAlumniIdToSend:C}=ge(),U=()=>{const s=new Date().getFullYear(),r=s+1,t=0,a=[];for(let c=0;c<=t;c++)a.push(s-c);return a.reverse().concat([r])},w=new Date().getFullYear();J.useEffect(()=>{(async()=>{try{const r=A(),t=await F.get("/api/scholars",{headers:{Authorization:`Bearer ${r}`}});t.status===200?(O(t.data.data),f(!0),b("Scholars fetched successfully")):(n(!0),o("Failed to fetch scholars"))}catch(r){r.response.status===401?j("/login"):(n(!0),o("Unable to fetch alumni forms. Please try again"))}})()},[]);const $=(s,r)=>{const t=l.find(a=>a.id===s);t?(E(t),P(r),j("/alumni-view")):(n(!0),o("Unable to view submission"))},R=s=>{C(s),y(!0)},v=()=>{C(null),y(!1)},H=async()=>{try{const s=A();if(!s){console.error("Authentication token is missing.");return}g(!0),D("Sending reminders..."),f(!0),b("Sending reminders..."),(await F.put(`/api/alumni-reminders/${G}`,null,{headers:{Authorization:`Bearer ${s}`}})).status===200?(b("Reminders sent successfully."),f(!0)):(o("Failed to send reminders."),n(!0)),g(!1),v()}catch(s){s.response.status===401?j("/login"):(o("Unable to send reminders. Please try again."),n(!0)),g(!1)}},d=L("year_submitted");return e.jsx(ue,{children:e.jsx(X,{theme:je,children:e.jsx(T,{maxWidth:"lg",sx:{mt:4,mb:4},children:e.jsxs(m,{container:!0,spacing:3,children:[e.jsx(m,{item:!0,xs:12,children:e.jsxs(m,{item:!0,sx:{display:"flex",alignItems:"center"},gap:4,xs:12,children:[e.jsx(q,{display:"flex",flexDirection:{xs:"column",sm:"row"},alignItems:{xs:"left",md:"center"},margin:2,justifyContent:"space-between",children:e.jsx(h,{variant:"h1",id:"tabsTitle",sx:{color:"black"},children:"Alumni Submission"})}),e.jsxs(m,{id:"schoolYearGrid",children:[e.jsx(Z,{htmlFor:"year_submitted",id:"schoolYearLabel"}),e.jsx(ve,{name:"year_submitted",id:"year_submitted",control:B,defaultValue:"",render:({field:s})=>e.jsxs(k,{native:!0,...s,sx:{border:"1px solid rgba(0,0,0,0.2)",boxShadow:"11px 7px 15px -3px rgba(0,0,0,0.1)",borderRadius:"15px",height:"50px"},children:[e.jsx("option",{value:"",children:"Select Year"}),U().map(r=>e.jsx("option",{value:r,children:`Year ${r}`},r))]})})]})]})}),e.jsxs(m,{sx:{borderRadius:"8px",boxShadow:"0 4px 8px rgba(0,0,0,0.1)",overflow:"auto",width:"100%"},children:[e.jsxs(T,{sx:{mt:4,mb:4,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(he,{children:[e.jsx(pe,{children:e.jsx(Q,{})}),e.jsx(xe,{placeholder:"Search for names, groups, or email addresses",inputProps:{"aria-label":"search"},value:u,onChange:z})]}),e.jsx(ee,{sx:{minWidth:120},children:e.jsxs(k,{value:S,onChange:s=>W(s.target.value),displayEmpty:!0,inputProps:{"aria-label":"Filter"},startAdornment:e.jsx(se,{position:"start",children:e.jsx(re,{viewBox:"0 0 24 24",sx:{width:20,height:20,color:"rgba(0, 0, 0, 0.54)"}})}),sx:{borderRadius:"12px"},children:[e.jsx(p,{value:"All",children:"All"}),e.jsx(p,{value:"For Approval",children:"For Approval"}),e.jsx(p,{value:"Approved",children:"Approved"}),e.jsx(p,{value:"For Resubmission",children:"For Resubmission"})]})})]}),e.jsxs(te,{sx:{backgroundColor:"#fbf3f2"},children:[e.jsxs(ie,{children:[e.jsx(ae,{children:e.jsxs(_,{children:[e.jsx(i,{sx:{fontWeight:"bold",fontSize:"1rem"},children:"Scholar's Name"}),e.jsx(i,{sx:{fontWeight:"bold",fontSize:"1rem"},children:"Status"}),e.jsx(i,{sx:{fontWeight:"bold",fontSize:"1rem"},children:"View Submission"}),e.jsx(i,{sx:{fontWeight:"bold",fontSize:"1rem"},children:"Action"})]})}),e.jsx(ne,{children:l.filter(s=>S==="All"?!0:Object.entries(s.alumni).some(([r,t])=>r===d&&t.some(a=>a.submission_status===S))).filter(s=>d===""?!0:Object.keys(s.alumni).some(r=>r===d)).filter(s=>`${s.user_first_name} ${s.user_middle_name||""} ${s.user_last_name}`.toLowerCase().includes(u==null?void 0:u.toLowerCase())).map((s,r)=>{var t;return e.jsxs(K.Fragment,{children:[(t=s.alumni[d])==null?void 0:t.map((a,c)=>e.jsxs(_,{className:"user",children:[e.jsx(i,{children:`${s.user_first_name} ${s.user_middle_name||""} ${s.user_last_name}`}),e.jsx(i,{children:a.submission_status==="For Approval"?e.jsx("span",{className:"For_Approval",children:"For Approval"}):a.submission_status==="Approved"?e.jsx("span",{className:"Approved",children:"Approved"}):a.submission_status==="For Resubmission"?e.jsx("span",{className:"For_Resubmission",children:"For Resubmission"}):e.jsx("span",{className:"No_Submission",children:"No Submission"})}),e.jsx(i,{children:e.jsx(N,{color:"inherit",onClick:()=>$(s.id,w),children:e.jsx(Y,{sx:{transform:"rotate(90deg)"}})})}),e.jsx(i,{sx:{color:"#2684ff"},children:e.jsxs(x,{variant:"contained",onClick:()=>R(s.id),children:[e.jsx(I,{}),e.jsx(h,{variant:"h5",children:"Send Reminders"})]})})]},`${r}-${d}-${c}`)),Object.keys(s.alumni).length===0&&e.jsxs(_,{className:"user",children:[e.jsx(i,{children:`${s.user_first_name} ${s.user_middle_name||""} ${s.user_last_name}`}),e.jsx(i,{children:e.jsx("span",{className:"No_Submission",children:"No Submission"})}),e.jsx(i,{children:e.jsx(N,{color:"inherit",onClick:()=>$(s.id,w),children:e.jsx(Y,{sx:{transform:"rotate(90deg)"}})})}),e.jsx(i,{sx:{color:"#2684ff"},children:e.jsxs(x,{variant:"contained",onClick:()=>R(s.id),children:[e.jsx(I,{}),e.jsx(h,{variant:"h5",children:"Send Reminders"})]})})]},`${r}-no-submission`)]},r)})})]}),e.jsx(oe,{sx:{width:"100%"}})]})]}),e.jsxs(le,{open:V,onClose:v,children:[e.jsx(de,{id:"dialogTitle",mt:2,children:"Send Reminders"}),e.jsx(ce,{children:e.jsxs(h,{variant:"h5",ml:1,sx:{color:"#44546F"},children:["You are about to send reminders to ",l.user_first_name," ",l.user_middle_name||""," ",l.user_last_name," for their Alumni submission. Are you sure you want to proceed?"]})}),e.jsxs(me,{children:[e.jsx(x,{color:"primary",onClick:v,children:"Cancel"}),e.jsx(x,{color:"primary",variant:"contained",sx:{borderRadius:"5px",mb:2,mt:2,backgroundColor:"#43a047","&:hover":{backgroundColor:"#43a047"}},onClick:H,children:"Send Reminder"})]})]})]})})})})}export{fs as default};
