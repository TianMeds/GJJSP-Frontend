import{r as k,j as e}from"./react-DyBbpTfo.js";import{L as he}from"./Layout-BTsGQOv-.js";import{L as ge}from"./react-router-dom-CzVCKb4Q.js";import{u as be}from"./SubmissionStore-Ceg7ZcXh.js";import"./classnames-BKHECdoj.js";import{i as je,G as i,g as x,a as o,k as C,B as re,t as ye,v as ve,w as we,x as f,y as d,z as ke,a5 as y,R as Ce,H as Se,J as De,K as Re,j as Ae,l as Ie,M as c,N as _e,S as se,A as te}from"./@mui-BieppYyU.js";import{a as Fe,b as ne}from"./index-CLUh4Q3Z.js";import{u as Oe}from"./LoaderAnimation-CH_DHjss.js";import{u as Le}from"./react-hook-form-BLdPXlwC.js";import"./@babel-8cBiVioP.js";import"./react-router-Cd-RU2wi.js";import"./@remix-run-B-RBrVrq.js";import"./UserStore-CIOHG4rb.js";import"./zustand-BzSMVJrz.js";import"./use-sync-external-store-C98n5-Y-.js";import"./theme-D40dVDi4.js";import"./react-dom-BKrvlAQh.js";import"./scheduler-CzFDRTuY.js";import"./clsx-B-dksMZM.js";import"./@emotion-C_NMWrO_.js";import"./hoist-non-react-statics-Buxaj0Kl.js";import"./react-is-8JwjhRSi.js";import"./stylis-BqmD5Vow.js";import"./react-transition-group-es_vqKy0.js";import"./@react-spring-V1f4ptoc.js";import"./d3-color-9lF95FHy.js";import"./d3-shape-D9lAmgB5.js";import"./d3-path-CimkQT29.js";import"./d3-scale-CFwq3Dxo.js";import"./internmap-BkD7Hj8s.js";import"./d3-array-DJclFi1f.js";import"./d3-format-CzD4bSOQ.js";import"./d3-interpolate-lgBfS8Nc.js";import"./d3-time-format-DZUSPL1N.js";import"./d3-time-Dz5jZYzf.js";import"./@popperjs-BQBsAJpH.js";import"./axios-B4uVmeYG.js";function Rr(){var F,O,L,T,W,M,N,E,z,G,P,B,Y,q,H,$,V,U,J,K,Q,X,Z,ee;const{getAuthToken:S,alertOpen:oe,alertMessage:ie,setAlertOpen:v,setAlertMessage:ae,errorOpen:le,setErrorOpen:p,setErrorMessage:w,errorMessage:de}=Fe(),{showPassword:Te,handleTogglePassword:We,setLoading:h,setLoadingMessage:ce}=Oe(),{renewalScholarData:Me,setRenewalScholarData:me,renewalSubmissionStatus:Ne,setRenewalSubmissionStatus:Ee,renewalValues:ze,setRenewalValues:Ge,selectedSubmission:s,setSelectedSubmission:Pe,passYear:t,passTerm:n,setPassYear:Be,setPassTerm:Ye,modalStatus:xe,setModalStatus:pe,handleCloseStatusModal:g,disapprovalRemarks:D,setDisapprovalRemarks:R}=be();k.useState([]);const[A,ue]=k.useState("");Le();const I=r=>{ue(r),pe(!0),R("")};k.useEffect(()=>{(async()=>{try{const a=S();if(!a){console.error("Missing or invalid auth token");return}const l=await ne.get("/api/scholars",{headers:{Authorization:`Bearer ${a}`}});l.status===200?me(l.data.data):console.error(`API request failed: ${l.status}`)}catch(a){console.error("Error fetching renewal data:",a)}})()},[s]);const b=(r,a=50)=>{const l=r.split("/"),m=l[l.length-1].split(".");m.pop();let u=m.join(".");return u.length>a&&(u=u.substring(0,a)+"..."),u},_=async r=>{var a;h(!0),ce("Updating submission...");try{const l=S(),j=(a=s.renewing[t])==null?void 0:a.find(fe=>fe.term===n);if(!j){w("Selected term not found"),p(!0),h(!1);return}let m="";r==="Approved"?m="Congratulations! You're approved. You can now submit your next term documents.":m=D,(await ne.put(`/api/renewal-submission/${j.id}`,{submission_status:r,term_submitted:j,remarks_message:m},{headers:{Authorization:`Bearer ${l}`}})).status===200?(ae("Submission status updated successfully"),v(!0),g()):(w("Failed to update submission status"),p(!0),g()),h(!1)}catch(l){h(!1),console.error("Error updating submission status:",l),w("Failed to update submission status"),p(!0)}};return e.jsx(he,{children:e.jsx(je,{maxWidth:"lg",sx:{mt:4,mb:4},children:e.jsxs(i,{container:!0,spacing:3,children:[e.jsxs(i,{container:!0,alignItems:"center",justifyContent:"space-between",sx:{padding:"20px",backgroundColor:"#f0f0f0",borderRadius:"8px",boxShadow:"0px 4px 4px rgba(0, 0, 0, 0.25)"},children:[e.jsx(i,{item:!0,children:e.jsx(x,{variant:"contained",component:ge,to:"/submitted-renewal",sx:{color:"#fff",backgroundColor:"#1976d2","&:hover":{backgroundColor:"#1565c0"}},children:"Close"})}),e.jsx(i,{item:!0,children:e.jsxs(o,{variant:"subtitle1",sx:{fontWeight:"bold"},children:["Scholar Name: ",s.user_first_name," ",s.user_middle_name||""," ",s.user_last_name]})}),e.jsx(i,{item:!0,children:e.jsxs(o,{variant:"subtitle1",sx:{fontWeight:"bold"},children:["Renewal Form: ",((O=(F=s.renewing[t])==null?void 0:F.find(r=>r.term===n))==null?void 0:O.submission_status)||"No Submission"]})}),e.jsx(i,{item:!0,children:e.jsxs(o,{variant:"subtitle1",sx:{fontWeight:"bold"},children:["SY: ",s.renewing&&Object.keys(s.renewing).length>0?Object.keys(s.renewing)[0]:"N/A Year"]})}),e.jsxs(i,{item:!0,children:[e.jsx(x,{variant:"contained",disabled:!s||!((L=s.renewing[t])!=null&&L.find(r=>r.term===n))||((W=(T=s.renewing[t])==null?void 0:T.find(r=>r.term===n))==null?void 0:W.submission_status)==="Approved"||((N=(M=s.renewing[t])==null?void 0:M.find(r=>r.term===n))==null?void 0:N.submission_status)==="For Resubmission",onClick:()=>I("Approved"),sx:{backgroundColor:"#4caf50",color:"#fff","&:hover":{backgroundColor:"#388e3c"}},children:"Approve"}),e.jsx(x,{variant:"contained",disabled:!s||!((E=s.renewing[t])!=null&&E.find(r=>r.term===n))||((G=(z=s.renewing[t])==null?void 0:z.find(r=>r.term===n))==null?void 0:G.submission_status)==="Approved"||((B=(P=s.renewing[t])==null?void 0:P.find(r=>r.term===n))==null?void 0:B.submission_status)==="For Resubmission",onClick:()=>I("Disapproved"),sx:{marginLeft:"10px",backgroundColor:"#f44336",color:"#fff","&:hover":{backgroundColor:"#f44336"}},children:"Disapprove"})]})]}),e.jsxs(i,{container:!0,item:!0,xs:12,sx:{mt:5,ml:2,display:"flex"},children:[e.jsxs(i,{item:!0,xs:12,children:[e.jsx(C,{htmlFor:"gwa_value",id:"gwaLabel",children:"1. General Weighted Average"}),e.jsx(re,{sx:{width:"100%",height:"50px",backgroundColor:"#f5f5f5",borderRadius:"4px",border:"1px solid #ccc",marginLeft:2,marginTop:2,display:"flex",alignItems:"center",padding:"1rem",fontSize:"1rem",color:"#333"},children:((q=(Y=s.renewing[t])==null?void 0:Y.find(r=>r.term===n))==null?void 0:q.gwa_value)||"No Gwa yet"})]}),e.jsxs(i,{item:!0,xs:12,mt:2,children:[e.jsx(C,{htmlFor:"gwa_remarks",id:"remarksLabel",children:"2. Add remarks about GWA"}),e.jsx(re,{sx:{width:"100%",height:"50px",backgroundColor:"#f5f5f5",borderRadius:"4px",border:"1px solid #ccc",marginLeft:2,marginTop:2,display:"flex",alignItems:"center",padding:"1rem",fontSize:"1rem",color:"#333"},children:(($=(H=s.renewing[t])==null?void 0:H.find(r=>r.term===n))==null?void 0:$.gwa_remarks)||"No Remarks yet"})]}),e.jsx(i,{item:!0,xs:12,children:e.jsx(o,{variant:"h5",sx:{fontWeight:"bold",mt:5},children:"Documentary Requirements"})}),e.jsxs(i,{item:!0,xs:12,sm:12,children:[e.jsxs(ye,{sx:{backgroundColor:"#fbf3f2",margin:"2rem 0 0 1rem"},children:[e.jsxs(ve,{children:[e.jsx(we,{children:e.jsxs(f,{children:[e.jsx(d,{children:"Description"}),e.jsx(d,{children:"File"})]})}),e.jsxs(ke,{children:[e.jsxs(f,{children:[e.jsx(d,{sx:{border:"none",display:"flex",alignItems:"flex-start",marginLeft:"-8px"},children:e.jsx(o,{variant:"body1",children:"Copy of Report Card of the previous semester"})}),e.jsx(d,{sx:{border:"none"},children:e.jsx(i,{sx:{display:"flex",alignItems:"center"},children:(U=(V=s.renewing[t])==null?void 0:V.find(r=>r.term===n))!=null&&U.copyOfReportCard?e.jsxs("a",{href:s.renewing[t].find(r=>r.term===n).copyOfReportCard,target:"_blank",rel:"noopener noreferrer",style:{textDecoration:"none",display:"flex",alignItems:"center",gap:"4px",color:"#1976d2",cursor:"pointer"},children:[e.jsx(y,{style:{fontSize:"1.2rem"}}),e.jsx(o,{variant:"body1",style:{color:"#1976d2",textDecoration:"none"},children:b(s.renewing[t].find(r=>r.term===n).copyOfReportCard)})]}):e.jsx(o,{variant:"body1",style:{color:"#1976d2",textDecoration:"none"},children:"No submission"})})})]}),e.jsxs(f,{children:[e.jsx(d,{sx:{border:"none",display:"flex",alignItems:"flex-start",marginLeft:"-8px"},children:e.jsx(o,{variant:"body1",children:"Copy of School Registration Form (RF)"})}),e.jsx(d,{sx:{border:"none"},children:e.jsx(i,{sx:{display:"flex",alignItems:"center"},children:(K=(J=s.renewing[t])==null?void 0:J.find(r=>r.term===n))!=null&&K.copyOfRegistrationForm?e.jsxs("a",{href:s.renewing[t].find(r=>r.term===n).copyOfRegistrationForm,target:"_blank",rel:"noopener noreferrer",style:{textDecoration:"none",display:"flex",alignItems:"center",gap:"4px",color:"#1976d2",cursor:"pointer"},children:[e.jsx(y,{style:{fontSize:"1.2rem"}}),e.jsx(o,{variant:"body1",style:{color:"#1976d2",textDecoration:"none"},children:b(s.renewing[t].find(r=>r.term===n).copyOfRegistrationForm)})]}):e.jsx(o,{variant:"body1",style:{color:"#1976d2",textDecoration:"none"},children:"No submission"})})})]}),e.jsxs(f,{children:[e.jsx(d,{sx:{border:"none",display:"flex",alignItems:"flex-start",marginLeft:"-8px"},children:e.jsx(o,{variant:"body1",children:"Scanned Written Essay"})}),e.jsx(d,{sx:{border:"none"},children:e.jsx(i,{sx:{display:"flex",alignItems:"center"},children:(X=(Q=s.renewing[t])==null?void 0:Q.find(r=>r.term===n))!=null&&X.scannedWrittenEssay?e.jsxs("a",{href:s.renewing[t].find(r=>r.term===n).scannedWrittenEssay,target:"_blank",rel:"noopener noreferrer",style:{textDecoration:"none",display:"flex",alignItems:"center",gap:"4px",color:"#1976d2",cursor:"pointer"},children:[e.jsx(y,{style:{fontSize:"1.2rem"}}),e.jsx(o,{variant:"body1",style:{color:"#1976d2",textDecoration:"none"},children:b(s.renewing[t].find(r=>r.term===n).scannedWrittenEssay)})]}):e.jsx(o,{variant:"body1",style:{color:"#1976d2",textDecoration:"none"},children:"No submission"})})})]}),e.jsxs(f,{children:[e.jsx(d,{sx:{border:"none",display:"flex",alignItems:"flex-start",marginLeft:"-8px"},children:e.jsx(o,{variant:"body1",children:" Letter of gratitude to benefactor"})}),e.jsx(d,{sx:{border:"none"},children:e.jsx(i,{sx:{display:"flex",alignItems:"center"},children:(ee=(Z=s.renewing[t])==null?void 0:Z.find(r=>r.term===n))!=null&&ee.letterOfGratitude?e.jsxs("a",{href:s.renewing[t].find(r=>r.term===n).letterOfGratitude,target:"_blank",rel:"noopener noreferrer",style:{textDecoration:"none",display:"flex",alignItems:"center",gap:"4px",color:"#1976d2",cursor:"pointer"},children:[e.jsx(y,{style:{fontSize:"1.2rem"}}),e.jsx(o,{variant:"body1",style:{color:"#1976d2",textDecoration:"none"},children:b(s.renewing[t].find(r=>r.term===n).letterOfGratitude)})]}):e.jsx(o,{variant:"body1",style:{color:"#1976d2",textDecoration:"none"},children:"No submission"})})})]})]})]}),e.jsx(Ce,{sx:{width:"100%"}})]}),e.jsxs(Se,{open:xe,onClose:g,children:[e.jsx(De,{id:"dialogTitle",mt:2,children:"Update Submission Status"}),e.jsx(Re,{children:A==="Approved"?e.jsx(o,{variant:"body1",ml:1,sx:{color:"#44546F"},children:"Are you sure you want to approve this submission?"}):e.jsxs(e.Fragment,{children:[e.jsx(o,{variant:"body1",ml:1,sx:{color:"#44546F"},children:"Please select a reason for disapproval:"}),e.jsxs(Ae,{fullWidth:!0,sx:{mt:2},children:[e.jsx(C,{id:"disapprovalRemarksLabel",children:"Disapproval Remarks"}),e.jsxs(Ie,{id:"disapprovalRemarks",value:D,onChange:r=>R(r.target.value),fullWidth:!0,label:"Disapproval Remarks",children:[e.jsx(c,{value:"",children:"Select a Reason"}),e.jsx(c,{value:"Outdated Documents",children:"Outdated Documents"}),e.jsx(c,{value:"GWA Doesn't Match",children:"GWA Doesn't Match in the Documentary"}),e.jsx(c,{value:"Missing Required Information",children:"Missing Required Information"}),e.jsx(c,{value:"Incomplete Application",children:"Incomplete Renewal Document"}),e.jsx(c,{value:"Incorrect Format",children:"Incorrect Format"}),e.jsx(c,{value:"Other",children:"Other"})]})]})]})}),e.jsxs(_e,{children:[e.jsx(x,{onClick:g,variant:"contained",sx:{backgroundColor:"#f44336",color:"#fff","&:hover":{backgroundColor:"#d32f2f"}},children:"Cancel"}),A==="Approved"?e.jsx(x,{onClick:()=>_("Approved"),variant:"contained",sx:{backgroundColor:"#4caf50",color:"#fff","&:hover":{backgroundColor:"#388e3c"},mb:2,mt:2,mr:1},children:"Approve"}):e.jsx(x,{onClick:()=>_("For Resubmission"),variant:"contained",sx:{marginLeft:"10px",backgroundColor:"#f44336",color:"#fff","&:hover":{backgroundColor:"#f44336"}},children:"Disapprove"})]})]}),e.jsx(se,{open:oe,autoHideDuration:5e3,onClose:()=>v(!1),anchorOrigin:{vertical:"top",horizontal:"right"},children:e.jsx(te,{onClose:()=>v(!1),variant:"filled",severity:"success",sx:{width:"100%"},children:ie})}),e.jsx(se,{open:le,autoHideDuration:5e3,onClose:()=>p(!1),anchorOrigin:{vertical:"top",horizontal:"right"},children:e.jsx(te,{onClose:()=>p(!1),variant:"filled",severity:"error",sx:{width:"100%"},children:de})})]})]})]})})})}export{Rr as default};
