const __vite__fileDeps=["assets/ErrMsg-DQePNNaK.js","assets/react-DyBbpTfo.js","assets/@babel-8cBiVioP.js","assets/LoaderAnimation-CH_DHjss.js","assets/zustand-BzSMVJrz.js","assets/use-sync-external-store-C98n5-Y-.js","assets/@mui-BieppYyU.js","assets/clsx-B-dksMZM.js","assets/@emotion-C_NMWrO_.js","assets/hoist-non-react-statics-Buxaj0Kl.js","assets/react-is-8JwjhRSi.js","assets/stylis-BqmD5Vow.js","assets/react-transition-group-es_vqKy0.js","assets/react-dom-BKrvlAQh.js","assets/scheduler-CzFDRTuY.js","assets/@react-spring-V1f4ptoc.js","assets/d3-color-9lF95FHy.js","assets/d3-shape-D9lAmgB5.js","assets/d3-path-CimkQT29.js","assets/d3-scale-CFwq3Dxo.js","assets/internmap-BkD7Hj8s.js","assets/d3-array-DJclFi1f.js","assets/d3-format-CzD4bSOQ.js","assets/d3-interpolate-lgBfS8Nc.js","assets/d3-time-format-DZUSPL1N.js","assets/d3-time-Dz5jZYzf.js","assets/@popperjs-BQBsAJpH.js","assets/LoaderAnimation-DD__M5Fb.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{u as Se,a as P,_ as Ae,b}from"./index-CLUh4Q3Z.js";import{j as e,r as k}from"./react-DyBbpTfo.js";import{G as o,a,B as l,T as Ce,L as Le,H as K,J as Q,K as ee,k as p,b as u,d as h,N as se,g as S,I as re,c as ae,e as te,f as oe,S as ie,A as ne}from"./@mui-BieppYyU.js";import{L as Te}from"./Layout-BTsGQOv-.js";import{u as de}from"./UserStore-CIOHG4rb.js";import{u as le}from"./LoaderAnimation-CH_DHjss.js";import{u as ke,P as Me}from"./ProfileHeader-HWvwdn_-.js";import{t as Fe}from"./theme-D40dVDi4.js";import{u as Be}from"./react-hook-form-BLdPXlwC.js";import{D as Ue}from"./@hookform-D0VPTTbZ.js";import{a as ze}from"./react-router-Cd-RU2wi.js";import"./react-dom-BKrvlAQh.js";import"./@babel-8cBiVioP.js";import"./scheduler-CzFDRTuY.js";import"./axios-B4uVmeYG.js";import"./zustand-BzSMVJrz.js";import"./use-sync-external-store-C98n5-Y-.js";import"./react-router-dom-CzVCKb4Q.js";import"./@remix-run-B-RBrVrq.js";import"./clsx-B-dksMZM.js";import"./@emotion-C_NMWrO_.js";import"./hoist-non-react-statics-Buxaj0Kl.js";import"./react-is-8JwjhRSi.js";import"./stylis-BqmD5Vow.js";import"./react-transition-group-es_vqKy0.js";import"./@react-spring-V1f4ptoc.js";import"./d3-color-9lF95FHy.js";import"./d3-shape-D9lAmgB5.js";import"./d3-path-CimkQT29.js";import"./d3-scale-CFwq3Dxo.js";import"./internmap-BkD7Hj8s.js";import"./d3-array-DJclFi1f.js";import"./d3-format-CzD4bSOQ.js";import"./d3-interpolate-lgBfS8Nc.js";import"./d3-time-format-DZUSPL1N.js";import"./d3-time-Dz5jZYzf.js";import"./@popperjs-BQBsAJpH.js";import"./little-state-machine-XjKmDAO7.js";import"./react-simple-animate-C3M8HUGx.js";import"./lodash-BeFwqRsT.js";import"./use-deep-compare-effect-DsItLPwu.js";import"./dequal-tFQomdd2.js";const We=({userId:f})=>{Se();const{user:m,setUser:M,selectedUser:i,setSelectedUser:F}=de();return le(),P(),e.jsxs(o,{container:!0,spacing:2,sx:{mt:5},children:[e.jsxs(o,{item:!0,xs:12,md:6,mb:2,children:[e.jsx(a,{variant:"h3",sx:{marginBottom:5},children:"Personal"}),e.jsxs(l,{sx:{height:"auto",border:"2px solid rgba(0,0,0,0.2)",boxShadow:"11px 7px 15px -3px rgba(0,0,0,0.1)",padding:"20px",borderRadius:"5px"},children:[e.jsxs(l,{children:[e.jsx(a,{variant:"h5",children:"Full Name"}),e.jsx(a,{sx:{textTransform:"uppercase",mt:2},children:i.first_name+" "+i.middle_name+" "+i.last_name})]}),e.jsxs(l,{sx:{mt:3},children:[e.jsx(a,{variant:"h5",children:"Role"}),e.jsx(a,{sx:{mt:2},children:i.role_id===1?"Scholarship Administrator":i.role_id===2?"Scholar Manager":i.role_id===3?"Scholar":"Unknown Role"})]})]})]}),e.jsxs(o,{item:!0,xs:12,md:6,children:[e.jsx(a,{variant:"h3",sx:{marginBottom:5},children:"Contact"}),e.jsxs(l,{sx:{height:"auto",border:"2px solid rgba(0,0,0,0.2)",boxShadow:"11px 7px 15px -3px rgba(0,0,0,0.1)",padding:"20px",borderRadius:"5px"},children:[e.jsxs(l,{children:[e.jsx(a,{variant:"h5",children:"Email Address"}),e.jsx(a,{sx:{mt:2},children:i.email_address})]}),e.jsxs(l,{sx:{mt:3},children:[e.jsx(a,{variant:"h5",children:"Mobile Number"}),e.jsx(a,{sx:{mt:2},children:i.user_mobile_num})]})]})]})]})},qe=k.lazy(()=>Ae(()=>import("./ErrMsg-DQePNNaK.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27]))),Xe={first_name:"",middle_name:"",last_name:"",user_mobile_num:"",email_address:"",password:"",role_id:"",user_status:""};function Ts(){var I,O,H,V,Y,Z,J;const f=Be(),{register:m,control:M,handleSubmit:i,formState:F,reset:Ge,watch:me,validate:Re}=f,{errors:s}=F,B=ze(),ce=me("password"),{profile:U,setProfiles:A,handleOpenProfile:z,handleCloseProfile:C,editProfile:W,setEditProfile:q,setSelectedProfile:pe,changePassword:X,handleOpenChangePassword:ue,handleCloseChangePassword:v,editPassword:he,setEditPassword:xe,setSelectedPassword:fe}=ke(),{getAuthToken:G,alertOpen:ge,alertMessage:je,setAlertOpen:x,setAlertMessage:y,errorOpen:we,setErrorOpen:c,setErrorMessage:N,errorMessage:_e}=P(),{selectedUser:R,setSelectedUser:$}=de(),{showPassword:E,handleTogglePassword:D,setLoading:t,setLoadingMessage:g}=le(),L=/^[A-Za-z.-]+(\s*[A-Za-z.-]+)*$/,be=/^(([^<>()[\]\.,;:\s@\"]+(\.[^<>()[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i,Pe=/^\+?63\d{10}$/,ve=async(r,d)=>{var j,w;d.preventDefault();const T={headers:{"Content-type":"application/json",Authorization:`Bearer ${P.getState().getAuthToken()}`}};try{if(t(!0),g("Updating profile..."),W){const _=await b.put(`/api/profile/${R.id}`,{...r},T);q(!1),C(),v(),A([_.data.data]),$(_.data.data),x(!0),y("Profile Updated"),t(!1)}response.status===200&&(A(response.data.data),$(response.data.data),x(!0),y("Profile Updated"),f.reset(Xe))}catch(_){((j=_.response)==null?void 0:j.status)===401?(t(!1),c(!0),N("You've been logout"),B("/login")):((w=_.response)==null?void 0:w.status)===409&&(t(!1),c(!0),N("Email already exists"))}},ye=async(r,d)=>{var j;d.preventDefault();const T={headers:{"Content-type":"application/json",Authorization:`Bearer ${P.getState().getAuthToken()}`}};try{t(!0),g("Updating password..."),(await b.put(`/api/profile/${R.id}`,{password:r.password},T)).status===200?(x(!0),y("Password Updated")):(c(!0),N("Failed to update password")),v(),t(!1)}catch(w){((j=w.response)==null?void 0:j.status)===401&&(c(!0),N("You've been logout"),B("/login"))}};k.useEffect(()=>{t(!0),c(!1),g("Fetching Updated Profile..."),(async()=>{try{const d=G(),n=await b.get("/api/profile",{headers:{Authorization:`Bearer ${d}`}});n.status===200&&(A(n.data.data),x(!0),y("You can now edit your profile"),t(!1))}catch(d){console.log(d)}})()},[]);const Ne=async()=>{t(!0),g("Please wait opening edit profile"),q(!0);try{const r=P.getState().getAuthToken(),n={...(await b.get("/api/profile",{headers:{Authorization:`Bearer ${r}`}})).data.data,password:void 0};pe(n),z(),f.reset(n),t(!1)}catch(r){console.error("Error fetching user data:",r)}},Ee=async()=>{t(!0),g("Please wait opening change password"),xe(!0);try{const r=G(),n={...(await b.get("/api/profile",{headers:{Authorization:`Bearer ${r}`}})).data.data,password:void 0};fe(n),ue(),f.reset(n),t(!1)}catch(r){console.error("Error fetching user data:",r)}};return e.jsx(Te,{children:e.jsxs(Ce,{theme:Fe,children:[e.jsxs(o,{item:!0,xs:12,md:8,lg:9,children:[e.jsx(l,{mb:4,sx:{display:"flex",alignItems:"center"},children:e.jsx(a,{variant:"h1",sx:{color:"black",fontWeight:"bold",marginRight:"auto"},children:"Profile"})}),e.jsx(l,{mb:4,children:e.jsx(a,{variant:"h5",children:"Manage your personal information, and control which information other people see"})}),e.jsx(l,{children:e.jsx(Le,{children:"Learn more about our data privacy policy."})}),e.jsx(Me,{handleOpenProfile:z,updateProfile:Ne,updatePassword:Ee}),e.jsx(We,{})]}),U&&e.jsxs(K,{open:U,onClose:C,fullWidth:!0,maxWidth:"xs",component:"form",method:"post",noValidate:!0,onSubmit:i(ve),children:[e.jsx(Q,{id:"dialogTitle",children:"Edit Profile"}),e.jsx(a,{variant:"body2",id:"dialogLabel",children:"Required fields are marked with an asterisk *"}),e.jsx(o,{sx:{marginLeft:3},children:e.jsx(k.Suspense,{fallback:"Scholarlink Loading...",children:e.jsx(qe,{})})}),e.jsxs(ee,{children:[e.jsxs(o,{id:"userNameGrid",children:[e.jsx(p,{htmlFor:"first_name",id:"userNameLabel",children:"First Name"}),e.jsx(u,{type:"text",id:"first_name",placeholder:"Name",fullWidth:!0,...m("first_name",{required:{value:!0,message:"First name is required"},pattern:{value:L,message:"Names should only contain letters, periods, and hypens, with no leading or hanging spaces."}})}),s.first_name&&e.jsxs("p",{id:"errMsg",children:[e.jsx(h,{className:"infoErr"}),(I=s.first_name)==null?void 0:I.message]})]}),e.jsxs(o,{id:"userNameGrid",children:[e.jsx(p,{htmlFor:"middle_name",id:"middleNameLabel",children:"Middle Name"}),e.jsx(u,{type:"text",id:"middle_name",placeholder:"Name",fullWidth:!0,...m("middle_name",{pattern:{value:L,message:"Names should only contain letters, periods, and hypens, with no leading or hanging spaces."}})}),s.middle_name&&e.jsxs("p",{id:"errMsg",children:[e.jsx(h,{className:"infoErr"}),(O=s.middle_name)==null?void 0:O.message]})]}),e.jsxs(o,{id:"userNameGrid",children:[e.jsx(p,{htmlFor:"last_name",id:"userNameLabel",children:"Last Name"}),e.jsx(u,{type:"text",id:"last_name",placeholder:"Name",fullWidth:!0,...m("last_name",{required:{value:!0,message:"Last name is required"},pattern:{value:L,message:"Names should only contain letters, periods, and hypens, with no leading or hanging spaces."}})}),s.last_name&&e.jsxs("p",{id:"errMsg",children:[e.jsx(h,{className:"infoErr"}),(H=s.last_name)==null?void 0:H.message]})]}),e.jsxs(o,{id:"userMobileNumGrid",children:[e.jsx(p,{htmlFor:"user_mobile_num",id:"userMobileNumLabel",children:"Mobile Number"}),e.jsx(u,{type:"text",id:"user_mobile_num",placeholder:"63XXX-XXXX-XXX",fullWidth:!0,...m("user_mobile_num",{required:{value:!0,message:"Mobile Number is required"},pattern:{value:Pe,message:"Enter your mobile number in 63 format with no spaces and symbol"}})}),s.user_mobile_num&&e.jsxs("p",{id:"errMsg",children:[" ",e.jsx(h,{className:"infoErr"})," ",(V=s.user_mobile_num)==null?void 0:V.message]})]}),e.jsxs(o,{id:"emailAddressGrid",children:[e.jsx(p,{htmlFor:"email_address",id:"emailAddressLabel",children:"Email"}),e.jsx(u,{type:"email",id:"email_address",placeholder:"Email Address",fullWidth:!0,...m("email_address",{required:{value:!0,message:"Email Address is required"},pattern:{value:be,message:"Please enter a valid email address"}})}),s.email_address&&e.jsxs("p",{id:"errMsg",children:[" ",e.jsx(h,{className:"infoErr"})," ",(Y=s.email_address)==null?void 0:Y.message]})]})]}),e.jsxs(se,{children:[e.jsx(S,{onClick:C,color:"primary",id:"Button",children:"Cancel"}),e.jsx(S,{color:"primary",type:"submit",variant:"contained",id:"addUserBtn",children:W?"Save Changes":""})]})]}),X&&e.jsxs(K,{open:X,onClose:v,fullWidth:!0,maxWidth:"xs",component:"form",method:"post",noValidate:!0,onSubmit:i(ye),children:[e.jsx(Q,{id:"dialogTitle",children:"Change Password"}),e.jsxs(ee,{children:[e.jsxs(o,{id:"userNameGrid",children:[e.jsx(p,{htmlFor:"password",id:"userNameLabel",children:"New Password"}),e.jsx(u,{type:E?"text":"password",id:"password",placeholder:"Password",fullWidth:!0,InputProps:{endAdornment:e.jsx(re,{position:"end",children:e.jsx(ae,{onClick:D,edge:"end",children:E?e.jsx(te,{sx:{fontSize:"1.2rem"}}):e.jsx(oe,{sx:{fontSize:"1.2rem"}})})})},...m("password",{required:{value:!0,message:"Password is required"},minLength:{value:8,message:"Password should be at least 8 characters long"}})}),s.password&&e.jsxs("p",{id:"errMsg",children:[e.jsx(h,{className:"infoErr"}),(Z=s.password)==null?void 0:Z.message]})]}),e.jsxs(o,{id:"userNameGrid",children:[e.jsx(p,{htmlFor:"confirmPassword",id:"confirmPasswordLabel",children:"Confirm Password"}),e.jsx(u,{type:E?"text":"password",id:"confirmPassword",placeholder:"Confirm password",fullWidth:!0,InputProps:{endAdornment:e.jsx(re,{position:"end",children:e.jsx(ae,{onClick:D,edge:"end",children:E?e.jsx(te,{sx:{fontSize:"1.2rem"}}):e.jsx(oe,{sx:{fontSize:"1.2rem"}})})})},...m("confirmPassword",{required:{value:!0,message:"Password is required"},minLength:{value:8,message:"Password should be at least 8 characters long"},validate:r=>r===ce||"The passwords do not match"})}),s.confirmPassword&&e.jsxs("p",{id:"errMsg",children:[e.jsx(h,{className:"infoErr"}),(J=s.confirmPassword)==null?void 0:J.message]})]})]}),e.jsxs(se,{children:[e.jsx(S,{onClick:v,color:"primary",id:"Button",children:"Cancel"}),e.jsx(S,{color:"primary",type:"submit",variant:"contained",id:"addUserBtn",children:he?"Save Changes":""})]})]}),e.jsx(Ue,{control:M}),e.jsx(ie,{open:ge,autoHideDuration:5e3,onClose:()=>x(!1),anchorOrigin:{vertical:"top",horizontal:"right"},children:e.jsx(ne,{onClose:()=>x(!1),variant:"filled",severity:"success",sx:{width:"100%"},children:je})}),e.jsx(ie,{open:we,autoHideDuration:5e3,onClose:()=>c(!1),anchorOrigin:{vertical:"top",horizontal:"right"},children:e.jsx(ne,{onClose:()=>c(!1),variant:"filled",severity:"error",sx:{width:"100%"},children:_e})})]})})}export{Ts as default};
