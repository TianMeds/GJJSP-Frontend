import{r as F,j as e}from"./react-DyBbpTfo.js";import{T as be,i as _e,G as t,B as k,a as u,k as d,l as M,g,ag as E,b as j,d as b,H as Q,J as X,K as Z,N as ee,t as ve,v as Ce,w as Se,x as te,y as p,z as Ae,S as se,A as re}from"./@mui-BieppYyU.js";import{L as De}from"./Layout-BTsGQOv-.js";import{L as B}from"./react-router-dom-CzVCKb4Q.js";import{t as Fe}from"./theme-D40dVDi4.js";import{a as ke,b as _}from"./index-CLUh4Q3Z.js";import{u as Te}from"./LoaderAnimation-CH_DHjss.js";import"./DashboardStore-DET_fa4r.js";import{u as we}from"./SubmissionStore-Ceg7ZcXh.js";import{u as Le,C as Y}from"./react-hook-form-BLdPXlwC.js";import{D as Me}from"./@hookform-D0VPTTbZ.js";import{a as Ee}from"./react-router-Cd-RU2wi.js";import"./@babel-8cBiVioP.js";import"./clsx-B-dksMZM.js";import"./@emotion-C_NMWrO_.js";import"./hoist-non-react-statics-Buxaj0Kl.js";import"./react-is-8JwjhRSi.js";import"./stylis-BqmD5Vow.js";import"./react-transition-group-es_vqKy0.js";import"./react-dom-BKrvlAQh.js";import"./scheduler-CzFDRTuY.js";import"./@react-spring-V1f4ptoc.js";import"./d3-color-9lF95FHy.js";import"./d3-shape-D9lAmgB5.js";import"./d3-path-CimkQT29.js";import"./d3-scale-CFwq3Dxo.js";import"./internmap-BkD7Hj8s.js";import"./d3-array-DJclFi1f.js";import"./d3-format-CzD4bSOQ.js";import"./d3-interpolate-lgBfS8Nc.js";import"./d3-time-format-DZUSPL1N.js";import"./d3-time-Dz5jZYzf.js";import"./@popperjs-BQBsAJpH.js";import"./UserStore-CIOHG4rb.js";import"./zustand-BzSMVJrz.js";import"./use-sync-external-store-C98n5-Y-.js";import"./@remix-run-B-RBrVrq.js";import"./axios-B4uVmeYG.js";import"./little-state-machine-XjKmDAO7.js";import"./react-simple-animate-C3M8HUGx.js";import"./lodash-BeFwqRsT.js";import"./use-deep-compare-effect-DsItLPwu.js";import"./dequal-tFQomdd2.js";const Be={company_name:"",company_location:"",position_in_company:"",licensure_exam_type:"",exam_passed_date:"",volunteer_group_name:"",yr_volunteered:""};function Et(){var J,W,G,R,U,z;const{getAuthToken:S,alertOpen:ae,alertMessage:ie,setAlertOpen:T,setAlertMessage:oe,errorOpen:ne,setErrorOpen:c,setErrorMessage:h,errorMessage:le}=ke(),{setLoading:x,setLoadingMessage:N}=Te(),{modalConfirmation:me,setModalConfirmation:Ye,modalHistory:de,setModalHistory:Ne,handleOpenHistoryModal:w,handleCloseHistoryModal:$,handleOpenConfirmationModal:ce,handleCloseConfirmationModal:L,userData:v,setUserData:q,editAlumni:$e,setEditAlumni:qe,updateData:O,setUpdateData:ue}=we(),[xe,pe]=F.useState({}),P=Le(),{register:f,control:A,handleSubmit:V,formState:he,reset:Oe,watch:D,validate:Pe,setValue:Ve}=P,{errors:l}=he,m=new Date().getFullYear(),H=Ee(),fe=s=>{const i=new Date(s),r=["January","February","March","April","May","June","July","August","September","October","November","December"][i.getMonth()],a=i.getDate(),C=i.getFullYear();let n=i.getHours();const y=i.getMinutes(),K=n>=12?"PM":"AM";n=n%12,n=n||12;const ye=y<10?"0"+y:y;return`${r} ${a}, ${C} - ${n}:${ye} ${K}`};F.useEffect(()=>{(async()=>{var r;const o={headers:{Authorization:`Bearer ${S()}`}};try{const a=await _.get("/api/scholar-alumni-documents",o);a.status===200?ue(a.data.data):(c(!0),h("Failed to fetch alumni data")),x(!1)}catch(a){((r=a.response)==null?void 0:r.status)===401?H("/login"):(c(!0),h("Failed to fetch alumni data"))}})()},[]),F.useEffect(()=>{(async()=>{var r;x(!0),N("Fetching Alumni Submission...");const o={headers:{Authorization:`Bearer ${S()}`}};try{const a=await _.get("/api/scholarsProfile",o);a.status===200?q(a.data.data):(c(!0),h("Failed to fetch scholar data")),x(!1)}catch(a){((r=a.response)==null?void 0:r.status)===401?H("/login"):(c(!0),h("Failed to fetch scholar data")),x(!1),c(!0),h("Failed to fetch scholar data")}})()},[]),F.useEffect(()=>{(async()=>{const o={headers:{Authorization:`Bearer ${S()}`}};try{const a=(await _.get("/api/users",o)).data.data,C={};a.forEach(n=>{C[n.id]=`${n.first_name} ${n.last_name}`}),pe(C)}catch{c(!0),h("Failed to fetch user data")}})()},[]);const I=async(s,i)=>{i.preventDefault(),x(!0),N("Submitting Alumni Form...");const r={headers:{"Content-type":"application/json",Authorization:`Bearer ${S()}`}};console.log("userData:",O),console.log("currentYear:",m);try{const a=O[0].submission_status;if(console.log("submissionStatus:",a),a==="For Resubmission"){console.log("Submitting as resubmission...");const y=await _.put(`/api/alumni-form/${v.alumni[m].id}`,{...s},r)}else{console.log("Submitting as new submission...");const y={year_submitted:s.year_submitted,company_name:s.company_name,company_location:s.company_location,position_in_company:s.position_in_company,licensure_exam_type:s.licensure_exam_type,exam_passed_date:s.exam_passed_date,volunteer_group_name:s.volunteer_group_name,yr_volunteered:s.yr_volunteered},K=await _.post("/api/alumni-form",JSON.stringify(y),r)}x(!1),P.reset(Be);const n=await _.get("/api/scholarsProfile",r);q(n.data.data),x(!1),L(),T(!0),oe("Alumni Submission submitted successfully")}catch{x(!1),c(!0),h("Failed to submit Alumni Form")}},ge=()=>{const s=v.alumni[m];if(s&&s.length>0){for(const i of s)if(i.submission_status==="For Approval"||i.submission_status==="Approved")return!0;return!1}return!1},je=v.scholar_status_id!==7;return e.jsx(De,{children:e.jsx(be,{theme:Fe,children:e.jsx(_e,{maxWidth:"lg",sx:{mt:4,mb:4},children:e.jsx(t,{container:!0,spacing:3,children:e.jsxs(t,{component:"form",method:"post",noValidate:!0,container:!0,spacing:3,sx:{mt:2,ml:2,display:"flex"},onSubmit:V(I),children:[je?e.jsxs(t,{item:!0,xs:12,children:[e.jsxs(k,{display:"flex",flexDirection:{xs:"column",sm:"row"},alignItems:{xs:"left",md:"center"},margin:2,justifyContent:"space-between",children:[e.jsx(u,{variant:"h1",id:"tabsTitle",sx:{color:"black"},children:"Alumni Submission"}),e.jsx(t,{sx:{display:"flex",alignItems:"center"},gap:4,xs:6,children:e.jsxs(t,{id:"schoolYearGrid",children:[e.jsx(d,{htmlFor:"year_submitted",id:"schoolYearLabel"}),e.jsx(Y,{name:"year_submitted",id:"year_submitted",control:A,defaultValue:m,render:({field:s})=>e.jsx(M,{native:!0,...s,disabled:!0,sx:{border:"1px solid rgba(0,0,0,0.2)",boxShadow:"11px 7px 15px -3px rgba(0,0,0,0.1)",borderRadius:"15px",height:"50px"},children:e.jsx("option",{value:m,children:` Year ${m}`})})})]})}),e.jsxs(g,{variant:"contained",component:B,to:"",id:"addButton",onClick:w,children:[e.jsx(E,{sx:{mr:1}}),e.jsx(u,{variant:"body2",children:"Submission history"})]})]}),e.jsx(t,{item:!0,xs:12,children:e.jsx(u,{variant:"h1",sx:{color:"#565369",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",height:"70vh"},children:"You are still not allowed to submit an alumni submission based on your Scholar Status. ðŸ˜Š"})})]}):e.jsx(e.Fragment,{children:ge()?e.jsxs(t,{item:!0,xs:12,children:[e.jsxs(k,{display:"flex",flexDirection:{xs:"column",sm:"row"},alignItems:{xs:"left",md:"center"},margin:2,justifyContent:"space-between",children:[e.jsx(u,{variant:"h1",id:"tabsTitle",sx:{color:"black"},children:"Alumni Submission"}),e.jsx(t,{sx:{display:"flex",alignItems:"center"},gap:4,xs:6,children:e.jsxs(t,{id:"schoolYearGrid",children:[e.jsx(d,{htmlFor:"year_submitted",id:"schoolYearLabel"}),e.jsx(Y,{name:"year_submitted",id:"year_submitted",control:A,defaultValue:m,render:({field:s})=>e.jsx(M,{native:!0,...s,disabled:!0,sx:{border:"1px solid rgba(0,0,0,0.2)",boxShadow:"11px 7px 15px -3px rgba(0,0,0,0.1)",borderRadius:"15px",height:"50px"},children:e.jsx("option",{value:m,children:` Year ${m}`})})})]})}),e.jsxs(g,{variant:"contained",component:B,to:"",id:"addButton",onClick:w,children:[e.jsx(E,{sx:{mr:1}}),e.jsx(u,{variant:"body2",children:"Submission history"})]})]}),e.jsx(t,{item:!0,xs:12,children:e.jsx(u,{variant:"h1",sx:{color:"#565369",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",height:"70vh"},children:"Thanks for submitting the Alumni Form. ðŸ˜Š"})})]}):e.jsx(e.Fragment,{children:e.jsxs(t,{container:!0,spacing:3,sx:{mt:2,ml:2,display:"flex"},children:[e.jsx(t,{item:!0,xs:12,children:e.jsxs(k,{display:"flex",flexDirection:{xs:"column",sm:"row"},alignItems:{xs:"left",md:"center"},margin:2,justifyContent:"space-between",children:[e.jsx(u,{variant:"h1",id:"tabsTitle",sx:{color:"black"},children:"Alumni Submission"}),e.jsx(t,{sx:{display:"flex",alignItems:"center"},gap:4,xs:6,children:e.jsxs(t,{id:"schoolYearGrid",children:[e.jsx(d,{htmlFor:"year_submitted",id:"schoolYearLabel"}),e.jsx(Y,{name:"year_submitted",id:"year_submitted",control:A,defaultValue:m,render:({field:s})=>e.jsx(M,{native:!0,...s,disabled:!0,sx:{border:"1px solid rgba(0,0,0,0.2)",boxShadow:"11px 7px 15px -3px rgba(0,0,0,0.1)",borderRadius:"15px",height:"50px"},children:e.jsx("option",{value:m,children:` Year ${m}`})})})]})}),e.jsxs(g,{variant:"contained",component:B,to:"",id:"addButton",onClick:w,children:[e.jsx(E,{sx:{mr:1}}),e.jsx(u,{variant:"body2",children:"Submission history"})]})]})}),e.jsx(t,{item:!0,xs:12,md:4,mt:5,children:e.jsxs(t,{container:!0,spacing:3,children:[e.jsxs(t,{item:!0,xs:12,children:[e.jsx(d,{htmlFor:"company_name",id:"currentCompanyLabel",children:"1. Current Company Name"}),e.jsx(j,{id:"company_name",placeholder:"Company Name",fullWidth:!0,margin:"normal",sx:{background:"#f5f5f5",color:"#00000",marginLeft:2,height:"auto",marginBottom:2},...f("company_name",{required:{value:!0,message:"Company Name is required"}})}),l.company_name&&e.jsxs("p",{id:"errMsg",children:[e.jsx(b,{className:"infoErr"}),(J=l.company_name)==null?void 0:J.message]})]}),e.jsxs(t,{item:!0,xs:12,children:[e.jsx(d,{htmlFor:"company_location",id:"currentCompanyLocationLabel",children:"2. Current Company Address"}),e.jsx(j,{id:"company_location",placeholder:"Company Full Address",fullWidth:!0,margin:"normal",sx:{background:"#f5f5f5",color:"#00000",marginLeft:2,height:"auto",marginBottom:2},...f("company_location",{required:{value:!0,message:"Company Location is required"}})}),l.company_location&&e.jsxs("p",{id:"errMsg",children:[e.jsx(b,{className:"infoErr"}),(W=l.company_location)==null?void 0:W.message]})]}),e.jsxs(t,{item:!0,xs:12,children:[e.jsx(d,{htmlFor:"position_in_company",id:"currentJobLabel",children:"3. Current Job Position"}),e.jsx(j,{id:"position_in_company",placeholder:"Job Position",fullWidth:!0,margin:"normal",sx:{background:"#f5f5f5",color:"#00000",marginLeft:2,height:"auto",marginBottom:2},...f("position_in_company",{required:{value:!0,message:"Job Position is required"}})}),l.position_in_company&&e.jsxs("p",{id:"errMsg",children:[e.jsx(b,{className:"infoErr"}),(G=l.position_in_company)==null?void 0:G.message]})]}),e.jsxs(t,{item:!0,xs:12,children:[e.jsx(d,{htmlFor:"licensure_exam_type",id:"licensureExamLabel",children:"4. Licensure Exam Type (If you take it)"}),e.jsx(j,{id:"licensure_exam_type",placeholder:"BAR, CPA, Board, and etc.",fullWidth:!0,margin:"normal",sx:{background:"#f5f5f5",color:"#00000",marginLeft:2,height:"auto",marginBottom:2},...f("licensure_exam_type",{required:{value:!1,message:"Licensure Exam Type is required"}})}),l.licensure_exam_type&&e.jsxs("p",{id:"errMsg",children:[e.jsx(b,{className:"infoErr"}),(R=l.licensure_exam_type)==null?void 0:R.message]})]})]})}),e.jsx(t,{item:!0,xs:12,md:4,children:e.jsxs(t,{container:!0,spacing:3,mt:2,children:[e.jsxs(t,{item:!0,xs:12,children:[e.jsx(d,{htmlFor:"exam_passed_date",id:"examDateLabel",children:"5. Exam Passed Date "}),e.jsx(j,{id:"exam_passed_date",type:"date",fullWidth:!0,margin:"normal",sx:{background:"#f5f5f5",color:"#00000",marginLeft:2,height:"auto",marginBottom:2},...f("exam_passed_date",{required:{value:D("licensure_exam_type")!=="",message:"Exam Passed Date is required when Licensure Exam Type is filled"}}),disabled:D("licensure_exam_type")===""}),l.exam_passed_date&&e.jsxs("p",{id:"errMsg",children:[e.jsx(b,{className:"infoErr"}),(U=l.exam_passed_date)==null?void 0:U.message]})]}),e.jsxs(t,{item:!0,xs:12,children:[e.jsx(d,{htmlFor:"volunteer_group_name",id:"volunteerGroupLabel",children:"6. Volunteer Group Name (If you volunteered)"}),e.jsx(j,{id:"volunteer_group_name",placeholder:"GJJSP Volunteer Group",fullWidth:!0,margin:"normal",sx:{background:"#f5f5f5",color:"#00000",marginLeft:2,height:"auto",marginBottom:2},...f("volunteer_group_name",{required:{value:!1}})}),l.volunteer_group_name&&e.jsxs("p",{id:"errMsg",children:[e.jsx(b,{className:"infoErr"}),(z=l.volunteer_group_name)==null?void 0:z.message]})]}),e.jsxs(t,{item:!0,xs:12,children:[e.jsx(d,{htmlFor:"yr_volunteered",id:"yearVolunteerLabel",children:"7. Year Volunteered (Optional)"}),e.jsx(j,{id:"yr_volunteered",placeholder:"2024",fullWidth:!0,margin:"normal",sx:{background:"#f5f5f5",color:"#00000",marginLeft:2,height:"auto",marginTop:2},...f("yr_volunteered",{required:{value:D("volunteer_group_name")!=="",message:"Year Volunteered is required when Volunteer Group Name is filled"}}),disabled:D("volunteer_group_name")===""})]})]})}),e.jsx(t,{item:!0,xs:12,sx:{mt:3,display:"flex",justifyContent:"flex-end"},children:e.jsx(k,{sx:{ml:1},children:e.jsx(g,{variant:"contained",sx:{mb:{xs:1,sm:0}},onClick:ce,children:"Submit"})})})]})})}),e.jsxs(Q,{open:me,onClose:L,children:[e.jsx(X,{id:"dialogTitle",mt:2,children:"Confirmation Heads Up"}),e.jsx(Z,{children:e.jsx(u,{variant:"h5",ml:1,sx:{color:"#44546F"},children:"You're about to submit your Alumni form. Are you sure you want to proceed?"})}),e.jsxs(ee,{children:[e.jsx(g,{onClick:L,children:"Cancel"}),e.jsx(g,{onClick:V(I),variant:"contained",children:"Submit"})]})]}),e.jsxs(Q,{open:de,onClose:$,maxWidth:"md",children:[e.jsx(X,{id:"dialogTitle",mt:2,children:"Submission History"}),e.jsx(Z,{children:e.jsx(ve,{children:e.jsxs(Ce,{children:[e.jsx(Se,{children:e.jsxs(te,{children:[e.jsx(p,{children:"Submission"}),e.jsx(p,{children:"Submitted Date"}),e.jsx(p,{children:"Status"}),e.jsx(p,{children:"Updated By"})]})}),e.jsx(Ae,{children:v.alumni&&Object.entries(v.alumni).map(([s,i])=>i.sort((o,r)=>new Date(r.updated_at)-new Date(o.updated_at)).map((o,r)=>e.jsxs(te,{children:[e.jsx(p,{children:"Alumni Submission"}),e.jsx(p,{children:fe(o.updated_at)}),e.jsx(p,{children:o.submission_status}),e.jsx(p,{children:xe[o.updated_by]||"Not yet updated"})]},r)))})]})})}),e.jsx(ee,{children:e.jsx(g,{onClick:$,variant:"contained",children:"Close"})})]}),e.jsx(se,{open:ae,autoHideDuration:5e3,onClose:()=>T(!1),anchorOrigin:{vertical:"top",horizontal:"right"},children:e.jsx(re,{onClose:()=>T(!1),variant:"filled",severity:"success",sx:{width:"100%"},children:ie})}),e.jsx(se,{open:ne,autoHideDuration:5e3,onClose:()=>c(!1),anchorOrigin:{vertical:"top",horizontal:"right"},children:e.jsx(re,{onClose:()=>c(!1),variant:"filled",severity:"error",sx:{width:"100%"},children:le})}),e.jsx(Me,{control:A})]})})})})})}export{Et as default};
